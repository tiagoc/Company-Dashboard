@{
    ViewBag.Title = "Artigos";
}
<div class="row" id="loading">
    <div class="col-md-6 col-md-offset-3">
        <div class="progress">
            <div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                <span class="sr-only">Carregando os artigos</span>
            </div>
        </div>
    </div>
</div>

<div id="artigos" hidden>
    <table id="tabelaArtigos" class="table table-striped">
        <thead>
            <tr>
                <td>Código</td>
                <td>Descrição</td>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>
<div class="alert alert-danger" role="alert" id="artigosErro" hidden>
    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
    <span class="sr-only">Erro:</span>
    <span id="message"></span>
</div>
<script>
    var request = $.get("/api/artigos");
    request.success(function (data) {
        for (Artigo in data) {
                $("#tabelaArtigos tbody").append("<tr><td>" + data[Artigo].CodArtigo + "</td>"
                                                  + "<td>" + data[Artigo].DescArtigo + "</td></tr>");
        }
        $(loading).fadeOut();
        $(artigos).fadeIn();
    }, 'json');
    request.error(function (jqXHR, textStatus, errorThrown) {
        if (textStatus == 'timeout') {
            $(loading).fadeOut();
            $('#artigosErro #message').append(' O servidor não está a responder');
            $(artigosErro).fadeIn();
        }

        if (textStatus == 'error') {
            $(loading).fadeOut();
            $('#artigosErro #message').append('Erro a obter os artigos: ' + errorThrown);
            $(artigosErro).fadeIn();
        }
    });
</script>
